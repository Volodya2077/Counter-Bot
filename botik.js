const { Telegraf, Markup } = require('telegraf');
require('dotenv').config()
const bot = new Telegraf(process.env.BOT_TOKEN);
let userState = {};
bot.start((ctx) => {
    console.log(ctx.update)
    ctx.reply(`–ü—Ä–∏–≤–µ—Ç,${ctx.update.message.from.first_name}, —Ä–∞–¥—ã —Ç–µ–±—è –≤–∏–¥–µ—Ç—å —É –Ω–∞—Åüßëüèª‚Äçüíª`, Markup
        .keyboard([
            ['–û –Ω–∞—Å', '–†–∞—Å—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏', '–û—Ç–∑—ã–≤—ã']   
        ]).oneTime())
});
bot.hears('–û –Ω–∞—Å', (ctx)=>{
    ctx.reply('–î–æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä —Å –ö–∏—Ç–∞—è/–ê–º–µ—Ä–∏–∫–∏ ‚úÖPoizon/95/Taobao/1688, –±–æ–ª—å—à–µ —É –Ω–∞—Å –≤ [–∫–∞–Ω–∞–ª–µ](https://t.me/AstanakLogistixxx/3) –∏ [–ê–≤–∏—Ç–æ](https://clck.ru/3KUjn2)',{
        parse_mode: "MarkdownV2", 
        ...Markup
            .keyboard([
                ['–†–∞—Å—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏', '–û—Ç–∑—ã–≤—ã']
            ])
            .oneTime()
            .resize()
    }
)})
bot.hears('–û—Ç–∑—ã–≤—ã', (ctx) => {
    ctx.reply(
        '–ú–Ω–æ–≥–æ –æ—Ç–∑—ã–≤–æ–≤ —É –Ω–∞—Å –≤ <a href="https://t.me/AstanakLogistixxx/599">–∫–∞–Ω–∞–ª–µ</a> –∏ –Ω–∞ <a href="https://clck.ru/3KUjn2">A–≤–∏—Ç–æ</a>, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏—â–∏—Ç–µ –ø–æ #–æ—Ç–∑—ã–≤—ã',
        {
            parse_mode: "HTML",
            ...Markup
                .keyboard([
                    ['–û –Ω–∞—Å', '–†–∞—Å—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏']
                ])
                .oneTime()
                .resize()
        }
    );
});


bot.hears('–†–∞—Å—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏',(ctx)=>{
    userState[ctx.from.id] = ctx.message.text
    ctx.reply('–í—ã–±–∏—Ä–∏—Ç–µ —Ç–∏–ø —Ç–æ–≤–∞—Ä–∞üõçÔ∏è',Markup
        .keyboard([
            ['–û–±—É–≤—åüëü', '–®—Ç–∞–Ω—ã/–¢–æ–ª—Å—Ç–æ–≤–∫–∏üëñ','–ö—É—Ä—Ç–∫–∏üèÇ'],
            ['–®–æ—Ä—Ç—ã/—Ñ—É—Ç–±–æ–ª–∫–∏üëï','–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã‚åöÔ∏è'],
            ['–í –º–µ–Ω—é‚òû']
        ]).oneTime().resize())
})
const media =  [
    {type: 'photo',
    media: { source: './excemple1.jpg',
    }},
    {type: 'photo',
    media: { source: './excample2.jpg'}
    },
]

bot.hears(['–û–±—É–≤—åüëü', '–®—Ç–∞–Ω—ã/–¢–æ–ª—Å—Ç–æ–≤–∫–∏üëñ', '–®–æ—Ä—Ç—ã/—Ñ—É—Ç–±–æ–ª–∫–∏üëï', '–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã‚åöÔ∏è','–ö—É—Ä—Ç–∫–∏üèÇ'], (ctx) => {
    userState[ctx.from.id] = ctx.message.text; 
    ctx.replyWithMediaGroup(media)
    ctx.reply('–í–≤–µ–¥–∏—Ç–µ —Ü–µ–Ω—É –≤ ¬•üí¥')
   
});
bot.hears('–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –µ—â—ëüßÆ', (ctx)=>{
    ctx.reply('–í—ã–±–∏—Ä–∏—Ç–µ —Ç–∏–ø —Ç–æ–≤–∞—Ä–∞üõçÔ∏è',Markup
        .keyboard([
            ['–û–±—É–≤—åüëü', '–®—Ç–∞–Ω—ã/–¢–æ–ª—Å—Ç–æ–≤–∫–∏üëñ','–ö—É—Ä—Ç–∫–∏üèÇ'],
            ['–®–æ—Ä—Ç—ã/—Ñ—É—Ç–±–æ–ª–∫–∏üëï','–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã‚åöÔ∏è'],
            ['–í –º–µ–Ω—é‚òû']
        ]).oneTime().resize())
})
bot.hears('–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑üßæ', (ctx)=>{
    ctx.reply('–î–ª—è –∑–∞–∫–∞–∑–∞ –ø–∏—à–∏—Ç–µ –º–Ω–µ –≤ –ª—Å @AstanakX',Markup.keyboard([
        ['–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –µ—â—ëüßÆ'],
        ['–í –º–µ–Ω—é‚òû']
    ]).oneTime().resize());
})

bot.hears('–í –º–µ–Ω—é‚òû',(ctx)=>{
    console.log(ctx.update)
    ctx.reply(`–ü—Ä–∏–≤–µ—Ç, ${ctx.update.message.from.first_name},—Ä–∞–¥—ã —Ç–µ–±—è –≤–∏–¥–µ—Ç—å —É –Ω–∞—Åüßëüèª‚Äçüíª`, Markup
        .keyboard([
            ['–û –Ω–∞—Å', '–†–∞—Å—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏', '–û—Ç–∑—ã–≤—ã'],
        ]).oneTime().resize(),{parse_mode: 'HTML'}
    )
})
bot.on('text', (ctx) => {
    const action = userState[ctx.from.id];
    let response;
    if (action){
        const input = parseFloat(ctx.message.text);

        if (!isNaN(input)) {
            
            switch (action) {
                case '–û–±—É–≤—åüëü':
                    response = `–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞ —Å —É—á—ë—Ç–æ–º –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏ –¥–æ –ú–æ—Å–∫–≤—ã: ${Math.floor(((input *12.6)+900+350))*0.1<500? Math.floor(((input *12.6)+900+350))+500:Math.floor(((input *12.6)+900+350)*1.1)}‚ÇΩ

*–í –¥—Ä—É–≥–∏–µ –≥–æ—Ä–æ–¥–∞ —Ü–µ–Ω–∞ –æ–±–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ*

–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ 13-25 –¥–Ω–µ–πüö¢
–ü–æ –ø–æ–≤–æ–¥—É –∞–≤–∏–∞ –¥–æ—Å—Ç–∞–≤–∫–∏üõ©Ô∏è  –ø–∏—Å–∞—Ç—å - @AstanakX
                    `; 
                    break;
                case '–®—Ç–∞–Ω—ã/–¢–æ–ª—Å—Ç–æ–≤–∫–∏üëñ':
                    response = `–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞ —Å —É—á—ë—Ç–æ–º –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏ –¥–æ –ú–æ—Å–∫–≤—ã: ${Math.floor(((input *12.6)+650+150)*0.1<500?Math.floor(((input *12.6)+650+150)+500):Math.floor(((input *12.6)+650+150)*1.1))}‚ÇΩ

*–í –¥—Ä—É–≥–∏–µ –≥–æ—Ä–æ–¥–∞ —Ü–µ–Ω–∞ –æ–±–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ*

–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ 13-25 –¥–Ω–µ–πüö¢
–ü–æ –ø–æ–≤–æ–¥—É –∞–≤–∏–∞ –¥–æ—Å—Ç–∞–≤–∫–∏üõ©Ô∏è  –ø–∏—Å–∞—Ç—å - @AstanakX
                        `; 
                    break;
                case '–®–æ—Ä—Ç—ã/—Ñ—É—Ç–±–æ–ª–∫–∏üëï':
                    response = `–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞ —Å —É—á—ë—Ç–æ–º –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏ –¥–æ –ú–æ—Å–∫–≤—ã: ${Math.floor(((input *12.6)+500+150)*0.1)<500?Math.floor(((input *12.6)+500+150)+500):Math.floor(((input *12.6)+500+150)*1.12)}‚ÇΩ

*–í –¥—Ä—É–≥–∏–µ –≥–æ—Ä–æ–¥–∞ —Ü–µ–Ω–∞ –æ–±–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ*

–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ 13-25 –¥–Ω–µ–πüö¢
–ü–æ –ø–æ–≤–æ–¥—É –∞–≤–∏–∞ –¥–æ—Å—Ç–∞–≤–∫–∏üõ©Ô∏è  –ø–∏—Å–∞—Ç—å - @AstanakX
                    `;  
                    break;
                case '–ö—É—Ä—Ç–∫–∏üèÇ':
                    response = `–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞ —Å —É—á—ë—Ç–æ–º –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏ –¥–æ –ú–æ—Å–∫–≤—ã: ${Math.floor(((input *12.6)+700+150)*0.1)<500?Math.floor(((input *12.6)+700+150)+500):Math.floor(((input *12.6)+700+150)*1.1)}‚ÇΩ

*–í –¥—Ä—É–≥–∏–µ –≥–æ—Ä–æ–¥–∞ —Ü–µ–Ω–∞ –æ–±–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ*

–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ 13-25 –¥–Ω–µ–πüö¢
–ü–æ –ø–æ–≤–æ–¥—É –∞–≤–∏–∞ –¥–æ—Å—Ç–∞–≤–∫–∏üõ©Ô∏è  –ø–∏—Å–∞—Ç—å - @AstanakX`
                case '–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã‚åöÔ∏è':
                    response = `–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞ —Å —É—á—ë—Ç–æ–º –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏ –¥–æ –ú–æ—Å–∫–≤—ã: ${Math.floor(((input *12.6)+550+250)*0.1)<500?Math.floor(((input *12.6)+550+250)+500):Math.floor(((input *12.6)+550+250)*1.1)}‚ÇΩ

*–í –¥—Ä—É–≥–∏–µ –≥–æ—Ä–æ–¥–∞ —Ü–µ–Ω–∞ –æ–±–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ*

–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ 13-25 –¥–Ω–µ–πüö¢
–ü–æ –ø–æ–≤–æ–¥—É –∞–≤–∏–∞ –¥–æ—Å—Ç–∞–≤–∫–∏üõ©Ô∏è  –ø–∏—Å–∞—Ç—å - @AstanakX
                     `;  
                    break;
                default:
                    response = '–Ø –≤–∞—Å –Ω–µ –ø–æ–Ω—è–ªüßê';
            }
            ctx.reply(response,Markup.keyboard([
                ['–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –µ—â—ëüßÆ'],
                ['–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑üßæ'],
                ['–í –º–µ–Ω—é‚òû']
            ]).oneTime().resize());
            
            delete userState[ctx.from.id];
        }else {
            ctx.reply('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ.');
        }
    } 
    
})

bot.launch()
    .then(() => {
        console.log('Bot is running');
    })
    .catch((error) => {
        console.error('Error launching bot:', error);
    })  